"use strict";(self.webpackChunkreact_virtual_drag_list=self.webpackChunkreact_virtual_drag_list||[]).push([[206],{62206:function(tn,P,h){h.r(P),h.d(P,{default:function(){return ot}});var Ne=h(19632),K=h.n(Ne),He=h(97857),p=h.n(He),Le=h(5574),X=h.n(Le),f=h(67294);function je(n,r){f.useEffect(r,Object.values(n))}var G=je,Ve=h(52677),We=h.n(Ve),Ye=h(12444),J=h.n(Ye),Pe=h(72004),Q=h.n(Pe),Xe=h(9783),m=h.n(Xe),Ge=h(26867),T=h.n(Ge);function Z(n,r){var e,t=function(){for(var i=this,a=arguments.length,c=new Array(a),v=0;v<a;v++)c[v]=arguments[v];e||(r<=0?n.apply(this,c):e=setTimeout(function(){e=null,n.apply(i,c)},r))};return t.cancel=function(){e&&(clearTimeout(e),e=null)},t}function U(n,r){var e=Z(n,r),t=function(){e.cancel(),e.apply(this,arguments)};return t.cancel=function(){e.cancel()},t}function M(n,r){return n==r}function q(n,r){return(Array.isArray(r)?r:r.replace(/\[/g,".").replace(/\]/g,".").split(".")).reduce(function(e,t){return(e||{})[t]},n)}function _(n){return n instanceof Document&&n.nodeType===9||n instanceof Window}var N=["delay","group","handle","lockAxis","disabled","sortable","draggable","animation","autoScroll","ghostClass","ghostStyle","chosenClass","scrollSpeed","fallbackOnBody","scrollThreshold","delayOnTouchOnly","placeholderClass"],Je=function(){function n(r,e){J()(this,n),m()(this,"el",void 0),m()(this,"options",void 0),m()(this,"sortable",void 0),m()(this,"reRendered",void 0),this.el=r,this.options=e,this.reRendered=!1,this.installSortable()}return Q()(n,[{key:"destroy",value:function(){this.sortable.destroy(),this.reRendered=!1}},{key:"option",value:function(e,t){this.options[e]=t,N.includes(e)&&this.sortable.option(e,t)}},{key:"installSortable",value:function(){var e=this,t=N.reduce(function(o,i){return o[i]=e.options[i],o},{});this.sortable=new(T())(this.el,p()(p()({},t),{},{emptyInsertThreshold:0,swapOnDrop:function(i){return i.from===i.to},removeCloneOnDrop:function(i){return i.from===i.to},onDrag:function(i){return e.onDrag(i)},onDrop:function(i){return e.onDrop(i)},onChoose:function(i){return e.onChoose(i)},onUnchoose:function(i){return e.onUnchoose(i)}}))}},{key:"onChoose",value:function(e){this.dispatchEvent("onChoose",e)}},{key:"onUnchoose",value:function(e){this.dispatchEvent("onUnchoose",e)}},{key:"onDrag",value:function(e){var t=e.node.getAttribute("data-key"),o=this.getIndex(t),i=this.options.list[o],a=this.options.uniqueKeys[o];this.sortable.option("store",{item:i,key:a,index:o}),this.dispatchEvent("onDrag",{item:i,key:a,index:o,event:e})}},{key:"onDrop",value:function(e){var t,o=(t=T().get(e.from))===null||t===void 0?void 0:t.option("store"),i=o.item,a=o.key,c=o.index,v=this.options.list,b={key:a,item:i,list:v,event:e,changed:!1,oldList:K()(v),oldIndex:c,newIndex:c};if(e.from===e.to&&e.node===e.target||this.handleDropEvent(e,b,c),this.dispatchEvent("onDrop",b),e.from===this.el&&this.reRendered){var y;(y=T().dragged)===null||y===void 0||y.remove()}if(e.from!==e.to){var z;(z=T().clone)===null||z===void 0||z.remove()}this.reRendered=!1}},{key:"handleDropEvent",value:function(e,t,o){var i=e.target.getAttribute("data-key"),a=-1,c=o;e.from===e.to?(c=this.getIndex(t.key),a=this.getIndex(i),(c<a&&e.relative===-1||c>a&&e.relative===1)&&(a+=e.relative),a!==c&&(t.list.splice(c,1),t.list.splice(a,0,t.item))):(e.from===this.el&&(c=this.getIndex(t.key),t.list.splice(c,1)),e.to===this.el&&(c=-1,a=this.getIndex(i),e.relative===0?a=t.list.length:e.relative===1&&(a+=e.relative),t.list.splice(a,0,t.item))),t.changed=e.from!==e.to||a!==c,t.oldIndex=c,t.newIndex=a}},{key:"getIndex",value:function(e){if(e==null)return-1;for(var t=this.options.uniqueKeys,o=0,i=t.length;o<i;o++)if(M(t[o],e))return o;return-1}},{key:"dispatchEvent",value:function(e,t){var o=this.options[e];o&&o(t)}}]),n}(),Qe=["size","keeps","scroller","direction","debounceTime","throttleTime"],Ze=function(){function n(r){J()(this,n),m()(this,"sizes",void 0),m()(this,"range",void 0),m()(this,"offset",void 0),m()(this,"options",void 0),m()(this,"scrollEl",void 0),m()(this,"direction",void 0),m()(this,"sizeType",void 0),m()(this,"fixedSize",void 0),m()(this,"averageSize",void 0),m()(this,"onScroll",void 0),this.options=r;var e={size:0,keeps:0,buffer:0,wrapper:null,scroller:null,direction:"vertical",uniqueKeys:[],debounceTime:null,throttleTime:null};for(var t in e)!(t in this.options)&&(this.options[t]=e[t]);this.sizes=new Map,this.sizeType="INIT",this.fixedSize=0,this.averageSize=0,this.range={start:0,end:0,front:0,behind:0,total:0},this.offset=0,this.direction="STATIONARY",this.updateScrollElement(),this.updateOnScrollFunction(),this.addScrollEventListener(),this.checkIfUpdate(0,r.keeps-1)}return Q()(n,[{key:"isFixed",value:function(){return this.sizeType==="FIXED"}},{key:"isFront",value:function(){return this.direction==="FRONT"}},{key:"isBehind",value:function(){return this.direction==="BEHIND"}},{key:"isHorizontal",value:function(){return this.options.direction==="horizontal"}},{key:"getSize",value:function(e){return this.sizes.get(e)||this.getItemSize()}},{key:"getOffset",value:function(){var e=this.isHorizontal()?"scrollLeft":"scrollTop";return this.scrollEl[e]}},{key:"getScrollSize",value:function(){var e=this.isHorizontal()?"scrollWidth":"scrollHeight";return this.scrollEl[e]}},{key:"getClientSize",value:function(){var e=this.isHorizontal()?"offsetWidth":"offsetHeight";return this.scrollEl[e]}},{key:"scrollToOffset",value:function(e){var t=this.isHorizontal()?"scrollLeft":"scrollTop";this.scrollEl[t]=e}},{key:"scrollToIndex",value:function(e){if(e>=this.options.uniqueKeys.length-1)this.scrollToBottom();else{var t=this.getOffsetByRange(0,e),o=this.getScrollStartOffset();this.scrollToOffset(t+o)}}},{key:"scrollToBottom",value:function(){var e=this,t=this.getScrollSize();this.scrollToOffset(t),setTimeout(function(){var o=e.getClientSize(),i=e.getScrollSize(),a=e.getOffset();a+o+1<i&&e.scrollToBottom()},5)}},{key:"option",value:function(e,t){var o=this,i=this.options[e];this.options[e]=t,e==="uniqueKeys"&&this.sizes.forEach(function(a,c){t.includes(c)||o.sizes.delete(c)}),e==="scroller"&&(i&&T().utils.off(i,"scroll",this.onScroll),this.updateScrollElement(),this.addScrollEventListener())}},{key:"updateRange",value:function(e){if(e){this.handleUpdate(e.start);return}var t=this.range.start;t=Math.max(t,0),this.handleUpdate(t)}},{key:"onItemResized",value:function(e,t){!t||this.sizes.get(e)===t||(this.sizes.set(e,t),this.sizeType==="INIT"?(this.sizeType="FIXED",this.fixedSize=t):this.isFixed()&&this.fixedSize!==t&&(this.sizeType="DYNAMIC",this.fixedSize=0),!this.averageSize&&this.sizeType==="DYNAMIC"&&this.sizes.size===this.options.keeps&&this.updateAverageSize())}},{key:"updateAverageSize",value:function(){var e=K()(this.sizes.values()).reduce(function(t,o){return t+o},0);this.averageSize=Math.round(e/this.sizes.size)}},{key:"addScrollEventListener",value:function(){this.options.scroller&&T().utils.on(this.options.scroller,"scroll",this.onScroll)}},{key:"removeScrollEventListener",value:function(){this.options.scroller&&T().utils.off(this.options.scroller,"scroll",this.onScroll)}},{key:"enableScroll",value:function(e){var t=this.options.scroller,o=e?T().utils.off:T().utils.on,i="onwheel"in document.createElement("div")?"wheel":"mousewheel";o(t,"DOMMouseScroll",this.preventDefault),o(t,i,this.preventDefault),o(t,"touchmove",this.preventDefault),o(t,"keydown",this.preventDefaultForKeyDown)}},{key:"preventDefault",value:function(e){e.preventDefault()}},{key:"preventDefaultForKeyDown",value:function(e){var t={37:1,38:1,39:1,40:1};if(t[e.keyCode])return this.preventDefault(e),!1}},{key:"updateScrollElement",value:function(){var e=this.options.scroller;if(_(e)){var t=document.scrollingElement||document.documentElement||document.body;this.scrollEl=t}else this.scrollEl=e}},{key:"updateOnScrollFunction",value:function(){var e=this,t=this.options,o=t.debounceTime,i=t.throttleTime;o?this.onScroll=U(function(){return e.handleScroll()},o):i?this.onScroll=Z(function(){return e.handleScroll()},i):this.onScroll=function(){return e.handleScroll()}}},{key:"handleScroll",value:function(){var e=this.getOffset(),t=this.getClientSize(),o=this.getScrollSize();e===this.offset?this.direction="STATIONARY":this.direction=e<this.offset?"FRONT":"BEHIND",this.offset=e;var i=this.isFront()&&e<=0,a=this.isBehind()&&t+e+1>=o;this.options.onScroll({top:i,bottom:a,offset:e,direction:this.direction}),this.isFront()?this.handleScrollFront():this.isBehind()&&this.handleScrollBehind()}},{key:"handleScrollFront",value:function(){var e=this.getScrollItems();if(!(e>=this.range.start)){var t=Math.max(e-this.options.buffer,0);this.checkIfUpdate(t,this.getEndByStart(t))}}},{key:"handleScrollBehind",value:function(){var e=this.getScrollItems();e<this.range.start+this.options.buffer||this.checkIfUpdate(e,this.getEndByStart(e))}},{key:"getScrollItems",value:function(){var e=this.offset-this.getScrollStartOffset();if(e<=0)return 0;if(this.isFixed())return Math.floor(e/this.fixedSize);for(var t=0,o=this.options.uniqueKeys.length,i=0,a=0;t<=o;){if(i=t+Math.floor((o-t)/2),a=this.getOffsetByRange(0,i),a===e)return i;a<e?t=i+1:a>e&&(o=i-1)}return t>0?--t:0}},{key:"checkIfUpdate",value:function(e,t){var o=this.options.keeps,i=this.options.uniqueKeys.length;i<=o?e=0:t-e<o-1&&(e=t-o+1),this.range.start!==e&&this.handleUpdate(e)}},{key:"handleUpdate",value:function(e){this.range.start=e,this.range.end=this.getEndByStart(e),this.range.front=this.getFrontOffset(),this.range.behind=this.getBehindOffset(),this.range.total=this.getTotalOffset(),this.options.onUpdate(p()({},this.range))}},{key:"getTotalOffset",value:function(){var e=this.range.front+this.range.behind;return e+=this.getOffsetByRange(this.range.start,this.range.end+1),e}},{key:"getFrontOffset",value:function(){return this.isFixed()?this.fixedSize*this.range.start:this.getOffsetByRange(0,this.range.start)}},{key:"getBehindOffset",value:function(){var e=this.range.end,t=this.getLastIndex();return this.isFixed()?(t-e)*this.fixedSize:(t-e)*this.getItemSize()}},{key:"getOffsetByRange",value:function(e,t){if(e>=t)return 0;for(var o=0,i=e;i<t;i++){var a=this.sizes.get(this.options.uniqueKeys[i]);o=o+(typeof a=="number"?a:this.getItemSize())}return o}},{key:"getEndByStart",value:function(e){return Math.min(e+this.options.keeps-1,this.getLastIndex())}},{key:"getLastIndex",value:function(){var e=this.options,t=e.uniqueKeys,o=e.keeps;return t.length>0?t.length-1:o-1}},{key:"getItemSize",value:function(){return this.isFixed()?this.fixedSize:this.options.size||this.averageSize}},{key:"getScrollStartOffset",value:function(){var e=this.options,t=e.wrapper,o=e.scroller;if(o===t)return 0;var i=0;if(o&&t){var a=this.isHorizontal()?"left":"top",c=_(o)?T().utils.getRect(t):T().utils.getRect(t,!0,o);i=this.offset+c[a]}return i}}]),n}();function qe(n){var r=n.itemClass,e=n.dataKey,t=n.sizeKey,o=n.dragging,i=n.chosenKey,a=n.children,c=n.onSizeChange,v=f.useRef(null);f.useLayoutEffect(function(){var y;if((typeof ResizeObserver=="undefined"?"undefined":We()(ResizeObserver))!==void 0){var z;y=new ResizeObserver(function(){var x=v.current[t];c(e,x)}),v.current&&((z=y)===null||z===void 0||z.observe(v.current))}return function(){y&&(y.disconnect(),y=null)}},[v]);var b=f.useMemo(function(){var y=a.props.style||{},z=M(e,i);return o&&z?Object.assign(y,{display:"none"}):y},[i,o]);return f.cloneElement(a,{"data-key":e,ref:v,style:b,className:[r,a.props.className].join(" ")})}var _e=f.memo(qe),H=h(85893);function et(n){var r=n.list,e=n.start,t=n.end,o=n.dataKey,i=n.sizeKey,a=n.dragging,c=n.chosenKey,v=n.children,b=n.itemClass,y=n.onSizeChange;return r.slice(e,t+1).map(function(z,x){var $=e+x,k=q(z,o);return(0,H.jsx)(_e,{dataKey:k,sizeKey:i,dragging:a,chosenKey:c,itemClass:b,onSizeChange:y,children:typeof v=="function"?v(z,$,k):v},k)})}var tt=et,R={drag:"onDrag",drop:"onDrop",top:"onTop",bottom:"onBottom"};function nt(n,r){var e=n.dataKey,t=e===void 0?"":e,o=n.dataSource,i=o===void 0?[]:o,a=n.tableMode,c=a===void 0?!1:a,v=n.wrapTag,b=v===void 0?"div":v,y=n.rootTag,z=y===void 0?"div":y,x=n.style,$=x===void 0?{}:x,k=n.className,it=k===void 0?"":k,ee=n.wrapStyle,te=ee===void 0?{}:ee,ne=n.wrapClass,rt=ne===void 0?"":ne,oe=n.itemClass,lt=oe===void 0?"virutal-dnd-list-item":oe,ie=n.size,st=ie===void 0?void 0:ie,re=n.keeps,D=re===void 0?30:re,le=n.scroller,B=le===void 0?void 0:le,se=n.direction,L=se===void 0?"vertical":se,ae=n.debounceTime,at=ae===void 0?0:ae,ue=n.throttleTime,ut=ue===void 0?0:ue,ce=n.delay,ct=ce===void 0?0:ce,de=n.group,dt=de===void 0?"":de,fe=n.handle,ft=fe===void 0?"":fe,he=n.lockAxis,ht=he===void 0?void 0:he,ve=n.disabled,vt=ve===void 0?!1:ve,ge=n.sortable,ye=ge===void 0?!0:ge,Se=n.draggable,gt=Se===void 0?".virutal-dnd-list-item":Se,pe=n.animation,yt=pe===void 0?150:pe,me=n.autoScroll,St=me===void 0?!0:me,ze=n.scrollSpeed,pt=ze===void 0?{x:10,y:10}:ze,Te=n.ghostClass,mt=Te===void 0?"":Te,be=n.ghostStyle,zt=be===void 0?void 0:be,Ce=n.chosenClass,Tt=Ce===void 0?"":Ce,Oe=n.placeholderClass,bt=Oe===void 0?"":Oe,xe=n.fallbackOnBody,Ct=xe===void 0?!1:xe,ke=n.scrollThreshold,Ot=ke===void 0?55:ke,Ie=n.delayOnTouchOnly,xt=Ie===void 0?!1:Ie,kt=f.useState({start:0,end:D-1,front:0,behind:0,total:0}),Ee=X()(kt,2),C=Ee[0],It=Ee[1],F=f.useRef(!1),w=f.useRef(""),I=f.useRef([]),j=f.useRef(),Ke=f.useRef(),Et=function(l){return g.current.getSize(l)},Re=function(){return g.current.getOffset()},$e=function(){return g.current.getClientSize()},De=function(){return g.current.getScrollSize()},Be=function(l){var u;(u=g.current)===null||u===void 0||u.scrollToOffset(l)},Kt=function(l){var u;(u=g.current)===null||u===void 0||u.scrollToIndex(l)},Rt=function(l){var u=I.current.indexOf(l);if(u>-1){var d;(d=g.current)===null||d===void 0||d.scrollToIndex(u)}},$t=function(){Be(0)},Dt=function(){var l;(l=g.current)===null||l===void 0||l.scrollToBottom()};f.useImperativeHandle(r,function(){return{getSize:Et,getOffset:Re,getClientSize:$e,getScrollSize:De,scrollToTop:$t,scrollToKey:Rt,scrollToIndex:Kt,scrollToOffset:Be,scrollToBottom:Dt}}),f.useEffect(function(){return Ut(),jt(),function(){var s,l;(s=g.current)===null||s===void 0||s.removeScrollEventListener(),(l=O.current)===null||l===void 0||l.destroy()}},[]);var A=f.useRef(!1),g=f.useRef(),Fe={size:st,keeps:D,scroller:B,direction:L,debounceTime:at,throttleTime:ut},Bt=U(function(){var s;A.current=!0,(s=n[R.top])===null||s===void 0||s.call(n)},50),Ft=U(function(){var s;(s=n[R.bottom])===null||s===void 0||s.call(n)},50),wt=function(l){A.current=!1,l.top?Bt():l.bottom&&Ft()},At=function(l){It(function(u){return O.current&&F.current&&l.start!==u.start&&(O.current.reRendered=!0),l})},Ut=function(){g.current=new Ze(p()(p()({},Fe),{},{buffer:Math.round(D/3),wrapper:Ke.current,scroller:B||j.current,uniqueKeys:I.current,onScroll:wt,onUpdate:At}))};G(Fe,function(){Qe.forEach(function(s){if(n[s]!==void 0){var l;(l=g.current)===null||l===void 0||l.option(s,n[s])}})});var V=f.useRef(0);f.useEffect(function(){if(V.current&&A.current&&n.keepOffset){var s=Math.abs(i.length-V.current);if(s>0){var l;(l=g.current)===null||l===void 0||l.scrollToIndex(s)}A.current=!1}V.current=i.length},[i]);var O=f.useRef(),we={delay:ct,group:dt,handle:ft,lockAxis:ht,disabled:vt,sortable:ye,draggable:gt,animation:yt,autoScroll:St,ghostClass:mt,ghostStyle:zt,chosenClass:Tt,scrollSpeed:pt,fallbackOnBody:Ct,scrollThreshold:Ot,delayOnTouchOnly:xt,placeholderClass:bt},Mt=function(l){w.current=l.node.getAttribute("data-key")},Nt=function(){w.current=""},Ht=function(l){var u;if(F.current=!0,!ye){var d,S;(d=g.current)===null||d===void 0||d.enableScroll(!1),(S=O.current)===null||S===void 0||S.option("autoScroll",!1)}(u=n[R.drag])===null||u===void 0||u.call(n,l)},Lt=function(l){var u,d,S;F.current=!1,(u=g.current)===null||u===void 0||u.enableScroll(!0),(d=O.current)===null||d===void 0||d.option("autoScroll",n.autoScroll);var E=p()(p()({},l),{},{list:K()(l.list)});(S=n[R.drop])===null||S===void 0||S.call(n,E)},jt=function(){O.current=new Je(j.current,p()(p()({},we),{},{list:i,uniqueKeys:I.current,onDrag:Ht,onDrop:Lt,onChoose:Mt,onUnchoose:Nt}))};G(we,function(){N.forEach(function(s){if(n[s]!==void 0){var l;(l=O.current)===null||l===void 0||l.option(s,n[s])}})});var Ae=f.useRef([]);f.useEffect(function(){var s;Vt(),Wt(Ae.current,i),Ae.current=i,(s=O.current)===null||s===void 0||s.option("list",i)},[i]);var Vt=function(){var l,u;I.current=i.map(function(d){return q(d,t)}),(l=g.current)===null||l===void 0||l.option("uniqueKeys",I.current),(u=O.current)===null||u===void 0||u.option("uniqueKeys",I.current)},Wt=function(l,u){var d;if(!(!l.length&&!u.length)&&l.length!==u.length){var S=p()({},C);u.length>l.length&&S.end===l.length-1&&Yt()&&S.start++,(d=g.current)===null||d===void 0||d.updateRange(S)}},Yt=function(){var l=Re(),u=$e(),d=De();return l+u+1>=d},Pt=function(l,u){var d,S;if(!M(l,w.current)){var E=(d=g.current)===null||d===void 0?void 0:d.sizes.size,Y=Math.min(D,i.length);(S=g.current)===null||S===void 0||S.onItemResized(l,u),E===Y-1&&g.current.updateRange(p()({},C))}},W=f.useMemo(function(){var s=C.front,l=C.behind,u=L!=="vertical",d=u?"auto hidden":"hidden auto",S=u?"0px ".concat(l,"px 0px ").concat(s,"px"):"".concat(s,"px 0px ").concat(l,"px"),E=p()(p()({},$),{},{overflow:c||B?"":d}),Y=p()(p()({},te),{},{padding:c?"":S}),en=u?"offsetWidth":"offsetHeight";return{containerStyle:E,wrapperStyle:Y,itemSizeKey:en}},[C,$,te,B,c,L]),Xt=W.containerStyle,Gt=W.wrapperStyle,Jt=W.itemSizeKey,Qt=f.useMemo(function(){var s=c?"table":b,l=c?"tbody":b;return[s,l]},[z,b,c]),Ue=X()(Qt,2),Zt=Ue[0],qt=Ue[1],_t=tt({list:i,start:C.start,end:C.end,dataKey:t,sizeKey:Jt,children:n.children,dragging:F.current,chosenKey:w.current,itemClass:lt,onSizeChange:Pt}),Me=function(l,u){var d={padding:0,border:0,height:"".concat(l,"px")};return(0,H.jsx)("tr",{children:(0,H.jsx)("td",{style:d})},u)};return f.createElement(Zt,{ref:j,style:Xt,className:it},[n.header,f.createElement(qt,{ref:Ke,key:"virtual-table-wrap",style:Gt,className:rt},[c&&Me(C.front,"virtual-table-front")].concat(K()(_t),[c&&Me(C.behind,"virtual-table-behind")])),n.footer])}var ot=f.forwardRef(nt)}}]);
