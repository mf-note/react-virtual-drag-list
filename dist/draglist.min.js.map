{"version":3,"file":"draglist.min.js","sources":["../src/interface.ts","../src/hooks.ts","../src/children.tsx","../src/utils.ts","../src/virtual.ts","../node_modules/sortable-dnd/dist/sortable.min.js","../src/sortable.ts","../src/index.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nexport type RenderFunc<T> = (\r\n  item: T,\r\n  index: number,\r\n  props: { style?: React.CSSProperties }\r\n) => React.ReactNode\r\n\r\nexport type GetKey<T> = (item: T) => React.Key\r\n\r\nexport interface BaseProps {\r\n  Tag?: string;\r\n  Class?: string;\r\n  Style?: object;\r\n  onSizeChange?: Function;\r\n  children?: React.ReactNode | ((ref: React.RefObject<any>) => React.ReactElement);\r\n}\r\n\r\nexport interface VirtualProps<T> {\r\n  dataSource: T[];\r\n  dataKey: string;\r\n  direction?: string; // scroll direction\r\n  keeps?: number; // the number of lines rendered by the virtual scroll\r\n  size?: number; // estimated height of each row\r\n\r\n  delay?: number; // Delay time of debounce function\r\n  height?: string; // list wrapper height\r\n\r\n  rootTag?: string;\r\n  wrapTag?: string;\r\n  itemTag?: string;\r\n  headerTag?: string;\r\n  footerTag?: string;\r\n\r\n  itemStyle?: object;\r\n  itemClass?: string;\r\n  rootStyle?: object;\r\n  rootClass?: string;\r\n  wrapStyle?: object;\r\n  wrapClass?: string;\r\n\r\n  disabled?: boolean; // Disables the sortable if set to true\r\n  draggable?: Function | string; // Specifies which items inside the element should be draggable, the function type must return a boolean\r\n  dragging?: Function; // Specifies the drag element, which must return an HTMLElement, such as (e) => e.target\r\n\r\n  ghostStyle?: object; // The style of the mask element when dragging\r\n  ghostClass?: string; // The class of the mask element when dragging\r\n  chosenClass?: string; // The class of the selected element when dragging\r\n  animation?: number; // Animation time\r\n  \r\n  children: RenderFunc<T>;\r\n  header: RenderFunc<T>;\r\n  footer: RenderFunc<T>;\r\n\r\n  'v-top'?: Function;\r\n  'v-bottom'?: Function;\r\n  'v-dragend'?: Function;\r\n}\r\n\r\nexport interface VirtualOptions<T> {\r\n  size: number;\r\n  keeps: number;\r\n  uniqueKeys: T[];\r\n  isHorizontal: boolean;\r\n}\r\n\r\nexport interface SortableOptions<T> {\r\n  getKey: Function;\r\n  scrollEl: HTMLElement;\r\n  dataSource: T[];\r\n  disabled: boolean;\r\n  draggable: string | Function;\r\n  dragging: Function;\r\n  ghostStyle: object;\r\n  ghostClass: string;\r\n  chosenClass: string;\r\n  animation: number;\r\n}\r\n\r\nexport class DragState {\r\n  from: {\r\n    key: string, // 拖拽起始节点唯一值\r\n    item: any, // 拖拽起始节点数据\r\n    index: number, // 拖拽起始节点索引\r\n  }\r\n  to: {\r\n    key: string, // 拖拽结束节点唯一值\r\n    item: any, // 拖拽结束节点数据\r\n    index: number // 拖拽结束节点索引\r\n  }\r\n  constructor() {\r\n    this.from = { key: null, item: null, index: -1 }\r\n    this.to = { key: null, item: null, index: -1 }\r\n  }\r\n}\r\n\r\nexport class CalcSize {\r\n  average: number; // 计算首次加载每一项的评价高度\r\n  total: number; // 首次加载的总高度\r\n  fixed: number; // 记录固定高度值\r\n  header: number; // 顶部插槽高度\r\n  footer: number; // 底部插槽高度\r\n  constructor() {\r\n    this.average = undefined\r\n    this.total = undefined\r\n    this.fixed = undefined\r\n    this.header = undefined\r\n    this.footer = undefined\r\n  }\r\n}\r\n\r\nexport class Range {\r\n  start: number;\r\n  end: number;\r\n  front: number;\r\n  behind: number;\r\n  constructor() {\r\n    this.start = 0\r\n    this.end = 0\r\n    this.front = 0\r\n    this.behind = 0\r\n  }\r\n}","import * as React from 'react'\r\n\r\nexport interface ObserverProps {\r\n  dataKey: string | number;\r\n\r\n  onSizeChange?: Function;\r\n\r\n  children?: React.ReactNode | ((ref: React.RefObject<any>) => React.ReactElement);\r\n}\r\n\r\nexport function Observer(props: ObserverProps) {\r\n\r\n  const { dataKey, children, onSizeChange } = props\r\n\r\n  const elementRef = React.useRef<Element>(null);\r\n\r\n  const isRenderProps = typeof children === 'function';\r\n  const mergedChildren = isRenderProps ? children(elementRef) : children;\r\n  \r\n  React.useLayoutEffect(() => {\r\n    let observer: ResizeObserver\r\n    if (typeof ResizeObserver !== undefined) {\r\n      observer = new ResizeObserver(() => {\r\n        const size = elementRef.current.clientHeight\r\n        onSizeChange && onSizeChange(dataKey, size)\r\n      })\r\n      elementRef.current && observer.observe(elementRef.current)\r\n    }\r\n    return () => {\r\n      if (observer) {\r\n        observer.disconnect()\r\n        observer = null\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [elementRef])\r\n\r\n  return React.cloneElement(mergedChildren as any, {\r\n    ref: elementRef,\r\n  })\r\n}\r\n\r\nexport function useRefCallback<T>(fn: Function, dependencies: Array<T>) {\r\n  const ref = React.useRef(fn)\r\n\r\n  // 每次调用的时候，fn 都是一个全新的函数，函数中的变量有自己的作用域\r\n  // 当依赖改变的时候，传入的 fn 中的依赖值也会更新，这时更新 ref 的指向为新传入的 fn\r\n  React.useEffect(() => {\r\n    ref.current = fn\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [fn, ...dependencies])\r\n\r\n  return React.useCallback(() => {\r\n    const fn = ref.current\r\n    return fn()\r\n  }, [ref])\r\n}\r\n\r\nexport function useMethods<T extends Record<string, (...args: any[]) => any>>(methods: T) {\r\n  const { current } = React.useRef({\r\n    methods,\r\n    func: undefined as T | undefined,\r\n  })\r\n  current.methods = methods\r\n\r\n  if (!current.func) {\r\n    const func = Object.create(null);\r\n    Object.keys(methods).forEach((key) => {\r\n      func[key] = (...args: unknown[]) => current.methods[key].call(current.methods, ...args)\r\n    })\r\n    current.func = func\r\n  }\r\n\r\n  return current.func as T\r\n}","import * as React from 'react'\r\nimport { Observer } from './hooks'\r\nimport { BaseProps } from './interface'\r\n\r\nexport interface ItemProps<T> extends BaseProps {\r\n  key: any;\r\n  record: T;\r\n  index: number;\r\n  dataKey: string | number;\r\n}\r\n\r\nexport function Item<T>(props: ItemProps<T>) {\r\n\r\n  const { children, dataKey, Class, Style, Tag = 'div' } = props\r\n\r\n  const { record, index, onSizeChange } = props\r\n\r\n  return (\r\n    <Observer dataKey={ dataKey } onSizeChange={ onSizeChange }>\r\n      <Tag\r\n        className={ Class }\r\n        style={ Style }\r\n        data-key={ dataKey }\r\n      >\r\n        { typeof children === 'function' ? children(record, index, dataKey) : children }\r\n      </Tag>\r\n    </Observer>\r\n  )\r\n}\r\n\r\nexport interface SlotProps<T> extends BaseProps {\r\n  roleId: string;\r\n}\r\n\r\nexport function Slot<T>(props: SlotProps<T>) {\r\n  \r\n  const { Tag = 'div', Style, Class, children, roleId, onSizeChange } = props\r\n\r\n  return children ? (\r\n    <Observer dataKey={ roleId } onSizeChange={ onSizeChange }>\r\n      <Tag\r\n        v-role={ roleId }\r\n        style={ Style }\r\n        className={ Class }\r\n      >\r\n        { children }\r\n      </Tag>\r\n    </Observer>\r\n  ) : <></>\r\n}","/**\r\n  * 防抖函数\r\n  * @param func callback\r\n  * @param delay 延迟\r\n  * @param immediate 是否立即执行\r\n  * @returns \r\n  */\r\nexport function debounce(func: Function, delay: number = 50, immediate:boolean = false){\r\n  let timer: any | undefined\r\n  let result: Function\r\n  let debounced = function(...args: any){\r\n    if(timer) clearTimeout(timer)\r\n    if(immediate){\r\n      let callNow = !timer\r\n      timer = setTimeout(()=>{\r\n        timer = null\r\n      }, delay)\r\n      if(callNow) result = func.apply(this, args)\r\n    } else{\r\n      timer = setTimeout(()=>{\r\n        func.apply(this, args)\r\n      }, delay)\r\n    }\r\n    return result\r\n  }\r\n  debounced.prototype.cancel = function(){\r\n    clearTimeout(timer)\r\n    timer = null\r\n  }\r\n  return debounced\r\n}\r\n\r\nexport default {\r\n  debounce\r\n}","import { VirtualOptions, CalcSize, Range } from \"./interface\"\r\n\r\nconst CACLTYPE = {\r\n  INIT: 'INIT',\r\n  FIXED: 'FIXED',\r\n  DYNAMIC: 'DYNAMIC'\r\n}\r\n\r\nconst DIRECTION = {\r\n  FRONT: 'FRONT',\r\n  BEHIND: 'BEHIND'\r\n}\r\n\r\nclass Virtual<T> {\r\n  options: VirtualOptions<T>;\r\n  callback: Function;\r\n\r\n  sizes: Map<T, number>; // 用于存储列表项的高度\r\n  isHorizontal: boolean; // 是否为横向滚动\r\n\r\n  calcIndex: number; // 记录上次计算的index\r\n  calcType: string; // 记录列表项高度是动态还是静态\r\n  calcSize: CalcSize;\r\n\r\n  range: Range;\r\n\r\n  direction: string; // 滚动方向\r\n  offset: number; // 记录滚动距离\r\n\r\n  constructor(options: VirtualOptions<T>, callback: Function) {\r\n    this.options = { ...options }\r\n    this.callback = callback\r\n\r\n    this.sizes = new Map()\r\n    this.isHorizontal = options.isHorizontal\r\n\r\n    this.calcIndex = 0\r\n    this.calcType = CACLTYPE.INIT\r\n    this.calcSize = new CalcSize\r\n\r\n    this.direction = ''\r\n    this.offset = 0\r\n\r\n    this.range = new Range\r\n    if (options) this.checkIfUpdate(0, options.keeps - 1)\r\n  }\r\n\r\n  // --------------------------- update ------------------------------\r\n  updateUniqueKeys(value: any) {\r\n    this.options.uniqueKeys = value\r\n  }\r\n\r\n  // 更新 sizes，删除不在当前列表中的数据\r\n  updateSizes(uniqueKeys: any) {\r\n    this.sizes.forEach((v, k) => {\r\n      if (!uniqueKeys.includes(k)) this.sizes.delete(k)\r\n    })\r\n  }\r\n\r\n  updateRange() {\r\n    const start = Math.max(this.range.start, 0)\r\n    this.handleUpdate(start, this.getEndByStart(start))\r\n  }\r\n\r\n  // --------------------------- scroll ------------------------------\r\n  // 滚动事件\r\n  handleScroll(offset: number) {\r\n    this.direction = offset < this.offset ? DIRECTION.FRONT : DIRECTION.BEHIND\r\n    this.offset = offset\r\n\r\n    const scrolls = this.getScrollItems(offset)\r\n\r\n    if (this.isFront()) {\r\n      this.handleScrollFront(scrolls)\r\n    } else if (this.isBehind()) {\r\n      this.handleScrollBehind(scrolls)\r\n    }\r\n  }\r\n\r\n  isFront() {\r\n    return this.direction === DIRECTION.FRONT\r\n  }\r\n\r\n  isBehind() {\r\n    return this.direction === DIRECTION.BEHIND\r\n  }\r\n\r\n  getScrollItems(offset: number) {\r\n    const { fixed, header } = this.calcSize\r\n    // 减去顶部插槽高度\r\n    if (header) offset -= header\r\n    if (offset <= 0) return 0\r\n    // 固定高度\r\n    if (this.calcType === CACLTYPE.FIXED) return Math.floor(offset / fixed)\r\n    // 非固定高度使用二分查找\r\n    let low = 0, high = this.options.uniqueKeys.length\r\n    let middle = 0, middleOffset = 0\r\n    while (low <= high) {\r\n      middle = low + Math.floor((high - low) / 2)\r\n      middleOffset = this.getOffsetByIndex(middle)\r\n      if (middleOffset === offset) return middle\r\n      else if (middleOffset < offset) low = middle + 1\r\n      else if (middleOffset > offset) high = middle - 1\r\n    }\r\n    return low > 0 ? --low : 0\r\n  }\r\n\r\n  handleScrollFront(scrolls: number) {\r\n    if (scrolls > this.range.start) return\r\n    const start = Math.max(scrolls - Math.round(this.options.keeps / 3), 0)\r\n    this.checkIfUpdate(start, this.getEndByStart(start))\r\n  }\r\n\r\n  handleScrollBehind(scrolls: number) {\r\n    if (scrolls < this.range.start + Math.round(this.options.keeps / 3)) return\r\n    this.checkIfUpdate(scrolls, this.getEndByStart(scrolls))\r\n  }\r\n\r\n  checkIfUpdate(start: number, end: number) {\r\n    const { uniqueKeys, keeps } = this.options\r\n    if (uniqueKeys.length <= keeps) {\r\n      start = 0\r\n      end = uniqueKeys.length - 1\r\n    } else if (end - start < keeps - 1) {\r\n      start = end - keeps + 1\r\n    }\r\n    if (this.range.start !== start) this.handleUpdate(start, end)\r\n  }\r\n\r\n  handleUpdate(start: number, end: number) {\r\n    this.range.start = start\r\n    this.range.end = end\r\n    this.range.front = this.getFrontOffset()\r\n    this.range.behind = this.getBehindOffset()\r\n    this.callback({ ...this.range })\r\n  }\r\n\r\n  getFrontOffset() {\r\n    if (this.calcType === CACLTYPE.FIXED) {\r\n      return this.calcSize.fixed * this.range.start\r\n    } else {\r\n      return this.getOffsetByIndex(this.range.start)\r\n    }\r\n  }\r\n\r\n  getBehindOffset() {\r\n    const last = this.getLastIndex()\r\n    if (this.calcType === CACLTYPE.FIXED) {\r\n      return (last - this.range.end) * this.calcSize.fixed\r\n    }\r\n    if (this.calcIndex === last) {\r\n      return this.getOffsetByIndex(last) - this.getOffsetByIndex(this.range.end)\r\n    }\r\n    return (last - this.range.end) * this.getItemSize()\r\n  }\r\n\r\n  getOffsetByIndex(index: number) {\r\n    if (!index) return 0\r\n    let offset = 0\r\n    for (let i = 0; i < index; i++) {\r\n      const size = this.sizes.get(this.options.uniqueKeys[i])\r\n      offset = offset + (typeof size === 'number' ? size : this.getItemSize())\r\n    }\r\n    this.calcIndex = Math.max(this.calcIndex, index - 1)\r\n    this.calcIndex = Math.min(this.calcIndex, this.getLastIndex())\r\n    return offset\r\n  }\r\n\r\n  getEndByStart(start: number) {\r\n    return Math.min(start + this.options.keeps - 1, this.getLastIndex())\r\n  }\r\n\r\n  getLastIndex() {\r\n    return this.options.uniqueKeys.length - 1\r\n  }\r\n\r\n  // --------------------------- size ------------------------------\r\n  // 获取列表项的高度\r\n  getItemSize() {\r\n    return this.calcType === CACLTYPE.FIXED ? this.calcSize.fixed : (this.calcSize.average || this.options.size)\r\n  }\r\n\r\n  // 列表项高度变化\r\n  handleItemSizeChange(id: T, size: number) {\r\n    this.sizes.set(id, size)\r\n\r\n    // 'INIT' 状态表示每一项的高度都相同\r\n    if (this.calcType === CACLTYPE.INIT) {\r\n      this.calcType = CACLTYPE.FIXED // 固定高度\r\n      this.calcSize.fixed = size\r\n    } else if (this.calcType === CACLTYPE.FIXED && this.calcSize.fixed !== size) {\r\n      // 如果当前为 'FIXED' 状态并且 size 与固定高度不同，表示当前高度不固定，fixed值也就不需要了\r\n      this.calcType = CACLTYPE.DYNAMIC\r\n      this.calcSize.fixed = undefined\r\n    }\r\n    // 非固定高度的情况下，计算平均高度与总高度\r\n    if (this.calcType !== CACLTYPE.FIXED) {\r\n      this.calcSize.total = [...this.sizes.values()].reduce((t, i) => t + i, 0)\r\n      this.calcSize.average = Math.round(this.calcSize.total / this.sizes.size)\r\n    }\r\n  }\r\n  \r\n  // header 插槽高度变化\r\n  handleHeaderSizeChange(size: number) {\r\n    this.calcSize.header = size\r\n  }\r\n\r\n  // footer 插槽高度变化\r\n  handleFooterSizeChange(size: number) {\r\n    this.calcSize.footer = size\r\n  }\r\n}\r\n\r\nexport default Virtual","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).Sortable=e()}(this,function(){\"use strict\";function d(t){return(d=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,o){e&&n(t.prototype,e),o&&n(t,o),Object.defineProperty(t,\"prototype\",{writable:!1})}function r(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(t){if(\"string\"==typeof t)return s(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return\"Map\"===(o=\"Object\"===o&&t.constructor?t.constructor.name:o)||\"Set\"===o?Array.from(t):\"Arguments\"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?s(t,e):void 0}}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function t(t){if(\"undefined\"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var a=t(/(?:Trident.*rv[ :]?11\\.|msie|iemobile|Windows Phone)/i),l=t(/Edge/i),f=t(/safari/i)&&!t(/chrome/i)&&!t(/android/i),e=t(/iP(ad|od|hone)/i),h=t(/chrome/i)&&t(/android/i),c={capture:!1,passive:!1},u=/\\s+/g,p=[\"-webkit-transition\",\"-moz-transition\",\"-ms-transition\",\"-o-transition\",\"transition\"],v=[\"-webkit-transform\",\"-moz-transform\",\"-ms-transform\",\"-o-transform\",\"transform\"];function m(e,o){o?\"none\"===o?p.forEach(function(t){return D(e,t,\"none\")}):p.forEach(function(t){return D(e,t,\"\".concat(t.split(\"transition\")[0],\"transform \").concat(o))}):p.forEach(function(t){return D(e,t,\"\")})}function g(e,o){o?v.forEach(function(t){return D(e,t,\"\".concat(t.split(\"transform\")[0]).concat(o))}):v.forEach(function(t){return D(e,t,\"\")})}function w(t,e,o,n){window.addEventListener?t.addEventListener(e,o,!(!n&&a)&&c):window.attachEvent&&t.attachEvent(\"on\"+e,o)}function y(t,e,o,n){window.removeEventListener?t.removeEventListener(e,o,!(!n&&a)&&c):window.detachEvent&&t.detachEvent(\"on\"+e,o)}function b(t){for(var e={top:0,left:0,height:0,width:0},o=(e.height=t.offsetHeight,e.width=t.offsetWidth,e.top=t.offsetTop,e.left=t.offsetLeft,t.offsetParent);null!==o;)e.top+=o.offsetTop,e.left+=o.offsetLeft,o=o.offsetParent;return e}function E(t){var e,o;if(t.getBoundingClientRect||t===window)return e={top:0,left:0,bottom:0,right:0,height:0,width:0},t!==window&&t.parentNode&&t!==(!(o=document.scrollingElement)||o.contains(document.body)?document:o)?(o=t.getBoundingClientRect(),e.top=o.top,e.left=o.left,e.bottom=o.bottom,e.right=o.right,e.height=o.height,e.width=o.width):(e.top=0,e.left=0,e.bottom=window.innerHeight,e.right=window.innerWidth,e.height=window.innerHeight,e.width=window.innerWidth),e}function S(t,e,o){var n=r(Array.from(t.children)),t=n.indexOf(e);if(-1<t)return o?n[t]:{index:t,el:n[t],rect:E(n[t]),offset:b(n[t])};for(var i=0;i<n.length;i++)if(function(t,e){var o;if(t&&e)for(o=t.parentNode;o;){if(e===o)return 1;o=o.parentNode}return}(e,n[i]))return o?n[i]:{index:i,el:n[i],rect:E(n[i]),offset:b(n[i])};return o?null:{index:-1,el:null,rect:{},offset:{}}}function _(t,e,o){var n;t&&e&&(t.classList?t.classList[o?\"add\":\"remove\"](e):(n=(\" \"+t.className+\" \").replace(u,\" \").replace(\" \"+e+\" \",\" \"),t.className=(n+(o?\" \"+e:\"\")).replace(u,\" \")))}function D(t,e,o){var n=t&&t.style;if(n){if(void 0===o)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(t,\"\"):t.currentStyle&&(o=t.currentStyle),void 0===e?o:o[e];n[e=e in n||-1!==e.indexOf(\"webkit\")?e:\"-webkit-\"+e]=o+(\"string\"==typeof o?\"\":\"px\")}}var x=function(){function t(){o(this,t),this.from={node:null,rect:{},offset:{}},this.to={node:null,rect:{},offset:{}}}return i(t,[{key:\"get\",value:function(t){return this[t]}},{key:\"set\",value:function(t,e){this[t]=e}},{key:\"destroy\",value:function(){this.from={node:null,rect:{},offset:{}},this.to={node:null,rect:{},offset:{}}}}]),t}(),$=function(){function e(t){o(this,e),this.options=t,this.diff={x:0,y:0},this.position={x:0,y:0},this.exist=!1}return i(e,[{key:\"init\",value:function(t,e){var o,n;this.$el&&this.$el.remove(),t&&(this.$el=t,o=(t=this.options).ghostClass,t=void 0===(t=t.ghostStyle)?{}:t,n=e.width,e=e.height,this.$el.class=o,this.$el.style.width=n+\"px\",this.$el.style.height=e+\"px\",this.$el.style.position=\"fixed\",this.$el.style.left=0,this.$el.style.top=0,this.$el.style.zIndex=1e5,this.$el.style.opacity=.8,this.$el.style.pointerEvents=\"none\",this.$el.style.cursor=\"move\",m(this.$el,\"none\"),g(this.$el,\"translate3d(0px, 0px, 0px)\"),this.setStyle(t))}},{key:\"setPosition\",value:function(t,e){this.position={x:t-this.diff.x,y:e-this.diff.y}}},{key:\"setStyle\",value:function(t){for(var e in t)D(this.$el,e,t[e])}},{key:\"rect\",value:function(){return E(this.$el)}},{key:\"move\",value:function(t){var e;this.$el&&(e=this.options.ghostAnimation,m(this.$el,t?\"\".concat(e,\"ms\"):\"none\"),this.exist||(document.body.appendChild(this.$el),this.exist=!0),g(this.$el,\"translate3d(\".concat(this.position.x,\"px, \").concat(this.position.y,\"px, 0)\")),\"move\"!==this.$el.style.cursor&&(this.$el.style.cursor=\"move\"))}},{key:\"destroy\",value:function(t){var e=this,t=(t&&(this.position={x:t.left,y:t.top},this.move(!0)),this.options.ghostAnimation);t?setTimeout(function(){return e.clear()},t):this.clear()}},{key:\"clear\",value:function(){this.$el&&this.$el.remove(),this.$el=null,this.diff={x:0,y:0},this.position={x:0,y:0},this.exist=!1}}]),e}();function P(){var i=[];return{captureAnimationState:function(){var t=r(Array.from(this.$el.children)),e=(o=t,n=this.dragEl,e=this.dropEl,n=o.indexOf(n),o=o.indexOf(e),n<o?{start:n,end:o}:{start:o,end:n}),o=e.start,n=e.end;i.length=0,t.slice(o,n+1).forEach(function(t){i.push({target:t,rect:E(t)})})},animateRange:function(){var o=this;i.forEach(function(t){var e=t.target,t=t.rect;o.animate(e,t,o.animation)})},animate:function(t,e){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:150,n=E(t),i=e.left-n.left,e=e.top-n.top;m(t,\"none\"),g(t,\"translate3d(\".concat(i,\"px, \").concat(e,\"px, 0)\")),t.offsetLeft,m(t,\"\".concat(o,\"ms\")),g(t,\"translate3d(0px, 0px, 0px)\"),clearTimeout(t.animated),t.animated=setTimeout(function(){m(t,\"\"),g(t,\"\"),t.animated=null},o)}}}var M=\"undefined\"!=typeof document&&!h&&!e&&\"draggable\"in document.createElement(\"div\");function O(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw\"Sortable: `el` must be an HTMLElement, not \".concat({}.toString.call(t));this.$el=t,this.options=e=Object.assign({},e),this.dragEl=null,this.dropEl=null,this.differ=null,this.ghost=null;var o,n,i={delay:0,delayOnTouchOnly:!1,disabled:!1,animation:150,ghostAnimation:0,ghostClass:\"\",ghostStyle:{},chosenClass:\"\",draggable:void 0,dragging:void 0,onDrag:void 0,onMove:void 0,onDrop:void 0,onChange:void 0,forceFallback:!1,stopPropagation:!1,supportPassive:(o=!1,document.addEventListener(\"checkIfSupportPassive\",null,{get passive(){return o=!0}}),o),supportPointer:\"PointerEvent\"in window&&!f,supportTouch:\"ontouchstart\"in window,ownerDocument:this.$el.ownerDocument};for(n in i)n in this.options||(this.options[n]=i[n]);this.nativeDraggable=!this.options.forceFallback&&M,this.differ=new x,this.ghost=new $(this.options),Object.assign(this,P(),{_bindEventListener:function(){this._onStart=this._onStart.bind(this),this._onMove=this._onMove.bind(this),this._onDrop=this._onDrop.bind(this);var t=this.options,e=t.supportPointer,o=t.supportTouch,t=t.supportPassive;w(this.$el,e?\"pointerdown\":o?\"touchstart\":\"mousedown\",this._onStart,t)},_unbindEventListener:function(){var t=this.options.supportPassive;y(this.$el,\"pointerdown\",this._onStart,t),y(this.$el,\"touchstart\",this._onStart,t),y(this.$el,\"mousedown\",this._onStart,t)},_bindMoveEvents:function(t){var e=this.options,o=e.supportPointer,n=e.ownerDocument,e=e.supportPassive;w(n,o?\"pointermove\":t?\"touchmove\":\"mousemove\",this._onMove,e)},_bindUpEvents:function(){var t=this.options,e=t.ownerDocument,t=t.supportPassive;w(e,\"pointerup\",this._onDrop,t),w(e,\"pointercancel\",this._onDrop,t),w(e,\"touchend\",this._onDrop,t),w(e,\"touchcancel\",this._onDrop,t),w(e,\"mouseup\",this._onDrop,t)},_unbindMoveEvents:function(){var t=this.options,e=t.ownerDocument,t=t.supportPassive;y(e,\"pointermove\",this._onMove,t),y(e,\"touchmove\",this._onMove,t),y(e,\"mousemove\",this._onMove,t)},_unbindUpEvents:function(){var t=this.options,e=t.ownerDocument,t=t.supportPassive;y(e,\"pointerup\",this._onDrop,t),y(e,\"pointercancel\",this._onDrop,t),y(e,\"touchend\",this._onDrop,t),y(e,\"touchcancel\",this._onDrop,t),y(e,\"mouseup\",this._onDrop,t)}}),this._bindEventListener(),this._handleDestroy()}return O.prototype={constructor:O,destroy:function(){this._unbindEventListener(),this._resetState()},_onStart:function(t){var e=this.options,o=e.delay,n=e.disabled,i=e.stopPropagation,e=e.delayOnTouchOnly;if(!(/mousedown|pointerdown/.test(t.type)&&0!==t.button||n)){var n=t.touches&&t.touches[0]||t.pointerType&&\"touch\"===t.pointerType&&t,r=n||t;if(this.nativeDraggable||!f||!r.target||\"SELECT\"!==r.target.tagName.toUpperCase()){if(r.target===this.$el)return!0;i&&t.stopPropagation(),!o||e&&!n||this.nativeDraggable&&(l||a)?this._onDrag(r,n):this.dragStartTimer=setTimeout(this._onDrag(r,n),o)}}},_onDrag:function(t,e){var o=this.options,n=o.draggable,o=o.dragging;if(\"function\"==typeof n){if(!n(t))return!0}else if(\"string\"==typeof n){if(!function(t,e){if(e&&(\">\"===e[0]&&(e=e.substring(1)),t))try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return}}(t.target,n))return!0}else if(void 0!==n)throw new Error('draggable expected \"function\" or \"string\" but received \"'.concat(d(n),'\"'));try{document.selection?setTimeout(function(){document.selection.empty()},0):window.getSelection().removeAllRanges()}catch(t){throw new Error(t)}if(o){if(\"function\"!=typeof o)throw new Error('dragging expected \"function\" or \"string\" but received \"'.concat(d(o),'\"'));this.dragEl=o(t)}else this.dragEl=S(this.$el,t.target,!0);if(!this.dragEl||this.dragEl.animated)return!0;n=S(this.$el,this.dragEl),o=n.rect,n=n.offset;window.sortableDndOnDownState=!0,this.ghost.setPosition(o.left,o.top),this.ghost.diff={x:t.clientX-o.left,y:t.clientY-o.top},this.differ.from={node:this.dragEl,rect:o,offset:n},this._bindMoveEvents(e),this._bindUpEvents(e)},_onMove:function(t){void 0!==t.preventDefault&&t.preventDefault();var e=this.options,o=e.chosenClass,n=e.stopPropagation,i=e.onMove,e=e.onDrag,n=(n&&t.stopPropagation(),t.touches&&t.touches[0]),r=n||t,s=r.clientX,a=r.clientY,n=n?document.elementFromPoint(s,a):r.target;if(!this.ghost.$el&&(this.ghost.init(this.dragEl.cloneNode(!0),this.differ.from.rect),void 0!==e)){if(\"function\"!=typeof e)throw new Error('onDrag expected \"function\" but received \"'.concat(d(e),'\"'));e(this.dragEl,r,t)}if(void 0!==i){if(\"function\"!=typeof i)throw new Error('onMove expected \"function\" but received \"'.concat(d(i),'\"'));i(this.differ.from,this.ghost.$el,r,t)}if(_(this.dragEl,o,!0),this.ghost.move(),window.sortableDndOnDownState&&!(s<0||a<0)){window.sortableDndOnMoveState=!0,this.ghost.setPosition(s,a),this.ghost.move();e=E(this.$el);if(s<e.left||s>e.right||a<e.top||a>e.bottom)this.ghost.setStyle({cursor:\"not-allowed\"});else{var i=S(this.$el,n),o=i.index,e=i.el,n=i.rect,i=i.offset,l=n.left,f=n.right,h=n.top,c=n.bottom;if(e&&!(o<0)&&(this.dropEl=e,l<s&&s<f&&h<a&&a<c&&e!==this.dragEl&&(this.differ.to={node:this.dropEl,rect:n,offset:i},!e.animated))){this.captureAnimationState();o=this.options.onChange,l=b(this.dragEl);if(void 0!==o){if(\"function\"!=typeof o)throw new Error('onChange expected \"function\" but received \"'.concat(d(o),'\"'));o(this.differ.from,this.differ.to,r,t)}l.top<i.top||l.left<i.left?this.$el.insertBefore(this.dragEl,e.nextElementSibling):this.$el.insertBefore(this.dragEl,e),this.animateRange()}}}},_onDrop:function(t){this._unbindMoveEvents(),this._unbindUpEvents(),clearTimeout(this.dragStartTimer);var e=this.options,o=e.onDrop,n=e.chosenClass;if(e.stopPropagation&&t.stopPropagation(),_(this.dragEl,n,!1),window.sortableDndOnDownState&&window.sortableDndOnMoveState){this.differ.to.offset=b(this.dragEl),this.differ.to.rect=E(this.dragEl);e=this.differ,n=e.from,e=e.to,n=n.offset.top!==e.offset.top||n.offset.left!==e.offset.left;if(void 0!==o){if(\"function\"!=typeof o)throw new Error('onDrop expected \"function\" but received \"'.concat(d(o),'\"'));o(n,t)}this.ghost.destroy(E(this.dragEl))}this.differ.destroy(),this._removeWindowState()},_resetState:function(){this.dragEl=null,this.dropEl=null,this.ghost.destroy(),this.differ.destroy(),this._removeWindowState()},_removeWindowState:function(){window.sortableDndOnDownState=null,window.sortableDndOnMoveState=null,window.sortableDndAnimationEnd=null,delete window.sortableDndOnDownState,delete window.sortableDndOnMoveState,delete window.sortableDndAnimationEnd},_handleDestroy:function(){var t=this,e=null,o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(o){var n=this.options.ownerDocument;if(!n)return;(e=new o(function(){n.body.contains(t.$el)||(e.disconnect(),e=null,t._unbindEventListener(),t._resetState())})).observe(this.$el.parentNode,{childList:!0,attributes:!1,subtree:!1})}window.onbeforeunload=function(){e&&e.disconnect(),e=null,t._unbindEventListener(),t._resetState()}}},O});\n","import SortableDnd from 'sortable-dnd'\r\nimport { SortableOptions, DragState } from './interface'\r\n\r\nclass Sortable<T> {\r\n  getKey: Function;\r\n  onDrag: Function;\r\n  onDrop: Function;\r\n  dragState: DragState;\r\n  dragElement: HTMLElement;\r\n  drag: SortableDnd;\r\n  options: SortableOptions<T>;\r\n  dataSource: T[];\r\n  rangeIsChanged: boolean;\r\n\r\n  constructor(options: SortableOptions<T>, onDrag:Function, onDrop: Function) {\r\n    this.options = options\r\n    this.onDrag = onDrag\r\n    this.onDrop = onDrop\r\n    this.getKey = options.getKey\r\n\r\n    this.dragState = new DragState\r\n    this.dataSource = options.dataSource\r\n    this.rangeIsChanged = false\r\n    this.init()\r\n  }\r\n\r\n  set(key, value) {\r\n    this[key] = value\r\n  }\r\n\r\n  init() {\r\n    this.destroy()\r\n\r\n    let cloneList = new Array()\r\n    this.drag = new SortableDnd(\r\n      this.options.scrollEl,\r\n      {\r\n        disabled: this.options.disabled,\r\n        draggable: this.options.draggable,\r\n        dragging: this.options.dragging,\r\n        ghostStyle: this.options.ghostStyle,\r\n        ghostClass: this.options.ghostClass,\r\n        chosenClass: this.options.chosenClass,\r\n        animation: this.options.animation,\r\n\r\n        onDrag: (dragEl: HTMLElement) => {\r\n          this.dragElement = dragEl\r\n          cloneList = [...this.dataSource]\r\n\r\n          const key = dragEl.getAttribute('data-key')\r\n          const index = this.dataSource.findIndex(el => this.getKey(el) == key)\r\n          const item = this.dataSource[index]\r\n          Object.assign(this.dragState.from, { item, index, key })\r\n\r\n          this.rangeIsChanged = false\r\n          this.onDrag(this.dragState.from)\r\n        },\r\n        onChange: (_old_, _new_) => {\r\n          const oldKey = this.dragState.from.key\r\n          const newKey = _new_.node.getAttribute('data-key')\r\n\r\n          const from = { item: null, index: -1 }\r\n          const to = { item: null, index: -1 }\r\n\r\n          cloneList.forEach((el, index) => {\r\n            const key = this.getKey(el)\r\n            if (key == oldKey) Object.assign(from, { item: el, index })\r\n            if (key == newKey) Object.assign(to, { item: el, index })\r\n          })\r\n\r\n          cloneList.splice(from.index, 1)\r\n          cloneList.splice(to.index, 0, from.item)\r\n        },\r\n        onDrop: (changed: boolean) => {\r\n          if (this.rangeIsChanged && this.dragElement) this.dragElement.remove()\r\n\r\n          const { from } = this.dragState\r\n          const index = cloneList.findIndex(el => this.getKey(el) == from.key)\r\n          const item = this.dataSource[index]\r\n          this.dragState.to = { item, index, key: this.getKey(item) }\r\n\r\n          this.onDrop(cloneList, from, this.dragState.to, changed)\r\n\r\n          this.dataSource = [...cloneList]\r\n          this.clear()\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  clear() {\r\n    this.dragElement = null\r\n    this.rangeIsChanged = false\r\n    this.dragState = new DragState\r\n  }\r\n\r\n  destroy() {\r\n    this.drag && this.drag.destroy()\r\n    delete this.drag\r\n  }\r\n}\r\n\r\nexport default Sortable","import React, { useRef, useState, useEffect, useLayoutEffect } from 'react'\r\nimport { VirtualProps, DragState, Range } from './interface'\r\nimport type { GetKey } from './interface'\r\nimport { Item, Slot } from './children'\r\nimport { debounce } from './utils'\r\nimport Virtual from './virtual'\r\nimport Sortable from './sortable'\r\n\r\nconst CALLBACKS = { top: 'v-top', bottom: 'v-bottom', dragend: 'v-dragend' } // 组件传入的事件回调\r\n\r\nexport function VirtualDragList<T>(props: VirtualProps<T>, ref: React.ref) {\r\n  const {\r\n    header,\r\n    footer,\r\n    children,\r\n\r\n    dataSource = [],\r\n    dataKey,\r\n    direction = 'vertical',\r\n    keeps = 30,\r\n    size = 50,\r\n\r\n    height = '100%',\r\n    delay = 0,\r\n\r\n    wrapTag = 'div',\r\n    rootTag = 'div',\r\n    itemTag = 'div',\r\n    headerTag = 'div',\r\n    footerTag = 'div',\r\n\r\n    itemStyle = {},\r\n    itemClass = '',\r\n    rootStyle = {},\r\n    rootClass = '',\r\n    wrapStyle = {},\r\n    wrapClass = '',\r\n\r\n    disabled = false,\r\n    draggable = undefined,\r\n    dragging = undefined,\r\n    ghostClass = '',\r\n    ghostStyle = {},\r\n    chosenClass = '',\r\n    animation = 150\r\n  } = props\r\n\r\n  // =============================== State ===============================\r\n  const [list, setList] = useState([])\r\n  const cloneList = useRef([])\r\n  const uniqueKeys = useRef([])\r\n\r\n  const [range, setRange] = useState<Range>(new Range) // 当前可见范围\r\n\r\n  const root_ref = useRef<Element>(null) // 根元素\r\n  const wrap_ref = useRef<Element>(null) // 列表ref\r\n  const last_ref = useRef<Element>(null) // 列表末尾dom，总是存在于列表最后\r\n\r\n  const dragState = useRef<DragState>(new DragState)\r\n  const sortable = useRef<Sortable<T>>(null)\r\n  const virtual = useRef<Virtual<T>>(new Virtual(\r\n    {\r\n      size,\r\n      keeps,\r\n      uniqueKeys: uniqueKeys.current,\r\n      isHorizontal: direction === 'vertical'\r\n    },\r\n    (range) => {\r\n      setRange(() => range)\r\n      // check if drag element is in range\r\n      const { index } = dragState.current.from || {}\r\n      if (index > -1 && !(index >= range.start && index <= range.end)) {\r\n        if (sortable.current) sortable.current.set('rangeIsChanged', true)\r\n      }\r\n    }\r\n  ))\r\n\r\n  // =============================== ref methods ===============================\r\n  /**\r\n   * reset component\r\n   */\r\n  const reset = () => {\r\n    scrollToTop()\r\n    setList(() => [...dataSource])\r\n    cloneList.current = [...dataSource]\r\n  }\r\n  /**\r\n   * git item size by data-key\r\n   * @param {String | Number} key data-key \r\n   */\r\n  const getSize = (key) => {\r\n    return virtual.current.sizes.get(key)\r\n  }\r\n  /**\r\n   * Get the current scroll height\r\n   */\r\n  const getOffset = () => {\r\n    const root = root_ref.current\r\n    return root ? Math.ceil(root[scrollDirectionKey]) : 0\r\n  }\r\n  /**\r\n   * Scroll to the specified offset\r\n   * @param {Number} offset \r\n   */\r\n  const scrollToOffset = (offset) => {\r\n    root_ref.current[scrollDirectionKey] = offset\r\n  }\r\n  /**\r\n   * Scroll to the specified index position\r\n   * @param {Number} index \r\n   */\r\n  const scrollToIndex = (index) => {\r\n    if (index >= dataSource.length - 1) {\r\n      scrollToBottom()\r\n    } else {\r\n      const indexOffset = virtual.current.getOffsetByIndex(index)\r\n      scrollToOffset(indexOffset)\r\n\r\n      setTimeout(() => {\r\n        const offset = getOffset()\r\n        const indexOffset = virtual.current.getOffsetByIndex(index)\r\n        if (offset !== indexOffset) scrollToIndex(index)\r\n      }, 5)\r\n    }\r\n  }\r\n  /**\r\n   * Scroll to top of list\r\n   */\r\n  const scrollToTop = () => {\r\n    root_ref.current[scrollDirectionKey] = 0\r\n  }\r\n  /**\r\n   * Scroll to bottom of list\r\n   */\r\n  const scrollToBottom = () => {\r\n    if (last_ref.current) {\r\n      const offset = last_ref.current[offsetSizeKey]\r\n      root_ref.current[scrollDirectionKey] = offset\r\n\r\n      // 第一次滚动高度可能会发生改变，如果没到底部再执行一次滚动方法\r\n      setTimeout(() => {\r\n        const root = root_ref.current\r\n        const offset = getOffset()\r\n        const clientSize = Math.ceil(root[clientSizeKey])\r\n        const scrollSize = Math.ceil(root[scrollSizeKey])\r\n        if (offset + clientSize < scrollSize) scrollToBottom()\r\n      }, 5)\r\n    }\r\n  }\r\n\r\n  React.useImperativeHandle(ref, () => ({\r\n    reset,\r\n    getSize,\r\n    getOffset,\r\n    scrollToTop,\r\n    scrollToIndex,\r\n    scrollToOffset,\r\n    scrollToBottom,\r\n  }))\r\n\r\n  // =============================== init ===============================\r\n  useEffect(() => {\r\n    setList(() => [...dataSource])\r\n    cloneList.current = [...dataSource]\r\n    setUniqueKeys()\r\n\r\n    virtual.current.updateUniqueKeys(uniqueKeys.current)\r\n    virtual.current.updateSizes(uniqueKeys.current)\r\n    virtual.current.updateRange()\r\n\r\n    if (sortable.current) sortable.current.set('dataSource', dataSource)\r\n  }, [dataSource])\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      destroyDraggable()\r\n    }\r\n  }, [])\r\n\r\n  useLayoutEffect(() => {\r\n    if (draggable) {\r\n      initDraggable()\r\n    } else {\r\n      destroyDraggable()\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [draggable])\r\n\r\n  // =============================== sortable ===============================\r\n  const initDraggable = () => {\r\n    destroyDraggable()\r\n    sortable.current = new Sortable(\r\n      {\r\n        getKey,\r\n        scrollEl: wrap_ref.current,\r\n        dataSource: cloneList.current,\r\n        disabled,\r\n        draggable,\r\n        dragging,\r\n        ghostStyle,\r\n        ghostClass,\r\n        chosenClass,\r\n        animation,\r\n      },\r\n      (state) => {\r\n        dragState.current.from = state\r\n      },\r\n      (list: T[], from: object, to: object, changed: boolean) => {\r\n        dragState.current.to = to\r\n\r\n        const callback = props[CALLBACKS.dragend]\r\n        callback && callback(list, from, to, changed)\r\n\r\n        cloneList.current = [...list]\r\n        setList(() => [...list])\r\n        setUniqueKeys()\r\n\r\n        setTimeout(() => dragState.current = new DragState, delay + 10)\r\n      }\r\n    )\r\n  }\r\n\r\n  const destroyDraggable = () => {\r\n    sortable.current && sortable.current.destroy()\r\n    sortable.current = null\r\n  }\r\n\r\n  // =============================== methods ===============================\r\n  const setUniqueKeys = () => {\r\n    uniqueKeys.current = cloneList.current.map(item => getKey(item))\r\n  }\r\n\r\n  const getItemIndex = (item) => {\r\n    return cloneList.current.findIndex(el => getKey(el) === getKey(item))\r\n  }\r\n\r\n  // 获取 item 中的 dateKey 值\r\n  const getKey = React.useCallback<GetKey<T>>(\r\n    (item: T) => {\r\n      return (\r\n        dataKey.replace(/\\[/g, '.').replace(/\\]/g, '').split('.').reduce((o, k) => (o || {})[k], item)\r\n      )\r\n    },\r\n    [dataKey]\r\n  )\r\n\r\n  const { scrollSizeKey, scrollDirectionKey, offsetSizeKey, clientSizeKey } = React.useMemo(() => {\r\n    const isHorizontal = direction !== 'vertical'\r\n    return {\r\n      offsetSizeKey: isHorizontal ? 'offsetLeft' : 'offsetTop',\r\n      scrollSizeKey: isHorizontal ? 'scrollWidth' : 'scrollHeight',\r\n      clientSizeKey: isHorizontal ? 'clientWidth' : 'clientHeight',\r\n      scrollDirectionKey: isHorizontal ? 'scrollLeft' : 'scrollTop',\r\n    }\r\n  }, [direction])\r\n\r\n  // =============================== Scroll ===============================\r\n  const handleScroll = (e: Event) => {\r\n    // mouseup 事件时会触发scroll事件，这里处理为了防止range改变导致页面滚动\r\n    if (dragState.current.to && dragState.current.to.key) return\r\n\r\n    const root = root_ref.current\r\n    const offset = getOffset()\r\n    const clientSize = Math.ceil(root[clientSizeKey])\r\n    const scrollSize = Math.ceil(root[scrollSizeKey])\r\n    // 如果不存在滚动元素 | 滚动高度小于0 | 超出最大滚动距离\r\n    if (offset < 0 || (offset + clientSize > scrollSize + 1) || !scrollSize) return\r\n\r\n    virtual.current.handleScroll(offset)\r\n    // 判断当前应该触发的回调函数，滚动到顶部时触发 `v-top`，滚动到底部时触发 `v-bottom`\r\n    if (virtual.current.isFront()) {\r\n      if (!!dataSource.length && offset <= 0) handleToTop(props)\r\n    } else if (virtual.current.isBehind()) {\r\n      if (clientSize + offset >= scrollSize) handleToBottom(props)\r\n    }\r\n  }\r\n\r\n  const handleToTop = debounce(function (props: VirtualProps<T>) {\r\n    const callback = props[CALLBACKS.top]\r\n    callback && callback()\r\n  })\r\n\r\n  const handleToBottom = debounce(function (props: VirtualProps<T>) {\r\n    const callback = props[CALLBACKS.bottom]\r\n    callback && callback()\r\n  })\r\n\r\n  // ======================= size observe =======================\r\n  const onItemSizeChange = (key: string | number, size: number) => {\r\n    virtual.current.handleItemSizeChange(key, size)\r\n  }\r\n\r\n  const onSlotSizeChange = (key: string | number, size: number) => {\r\n    if (key === 'header') virtual.current.handleHeaderSizeChange(size)\r\n    if (key === 'footer') virtual.current.handleFooterSizeChange(size)\r\n  }\r\n\r\n  // ================================ Render ================================\r\n  const { start, end, front, behind } = React.useMemo(() => {\r\n    return { ...range }\r\n  }, [range])\r\n\r\n  // check item show or not\r\n  const getItemStyle = React.useCallback((itemKey) => {\r\n    const change = sortable.current && sortable.current.rangeIsChanged\r\n    const { key } = dragState.current.from || {}\r\n    if (change && itemKey == key) return { display: 'none' }\r\n    return {}\r\n  }, [dragState.current])\r\n\r\n  const RootStyle = { ...rootStyle, height, overflow: direction !== 'vertical' ? 'auto hidden' : 'hidden auto' }\r\n  const WrapStyle = { ...wrapStyle, padding: direction !== 'vertical' ? `0px ${behind}px 0px ${front}px` : `${front}px 0px ${behind}px` }\r\n\r\n  const WrapTag = wrapTag\r\n  const RootTag = rootTag\r\n\r\n  return (\r\n    <RootTag ref={ root_ref } className={ rootClass } style={ RootStyle } onScroll={ debounce(handleScroll, delay) }>\r\n\r\n      <Slot children={ header } roleId=\"header\" Tag={ headerTag } onSizeChange={ onSlotSizeChange }></Slot>\r\n\r\n      <WrapTag ref={ wrap_ref } v-role=\"content\" className={ wrapClass } style={ WrapStyle }>\r\n        {\r\n          list.slice(start, end + 1).map(item => {\r\n            const key = getKey(item)\r\n            const index = getItemIndex(item)\r\n            return (\r\n              <Item\r\n                key={ key }\r\n                Tag={ itemTag }\r\n                record={ item }\r\n                index={ index }\r\n                dataKey={ key }\r\n                children={ children }\r\n                Class={ itemClass }\r\n                Style={{ ...itemStyle, ...getItemStyle(key) }}\r\n                onSizeChange={ onItemSizeChange }\r\n              />\r\n            )\r\n          })\r\n        }\r\n      </WrapTag>\r\n\r\n      <Slot children={ footer } roleId=\"footer\" Tag={ footerTag } onSizeChange={ onSlotSizeChange }></Slot>\r\n      <div ref={ last_ref }></div>\r\n    </RootTag>\r\n  )\r\n}\r\n\r\nexport default React.forwardRef(VirtualDragList)"],"names":["DragState","from","to","constructor","this","key","item","index","CalcSize","average","total","fixed","header","footer","undefined","Range","start","end","front","behind","Observer","props","dataKey","children","onSizeChange","elementRef","React","useRef","mergedChildren","useLayoutEffect","let","observer","ResizeObserver","size","current","clientHeight","observe","disconnect","cloneElement","ref","Item","Class","Style","Tag","record","className","style","Slot","roleId","debounce","func","delay","immediate","timer","result","debounced","args","callNow","clearTimeout","setTimeout","apply","prototype","cancel","CACLTYPE","INIT","FIXED","DYNAMIC","DIRECTION","FRONT","BEHIND","Virtual","options","callback","sizes","isHorizontal","calcIndex","calcType","calcSize","range","direction","offset","Map","checkIfUpdate","keeps","updateUniqueKeys","value","uniqueKeys","updateSizes","forEach","v","k","includes","delete","updateRange","Math","max","handleUpdate","getEndByStart","handleScroll","scrolls","getScrollItems","isFront","handleScrollFront","isBehind","handleScrollBehind","floor","low","high","length","middle","middleOffset","getOffsetByIndex","round","getFrontOffset","getBehindOffset","last","getLastIndex","getItemSize","i","get","min","handleItemSizeChange","id","set","values","reduce","t","handleHeaderSizeChange","handleFooterSizeChange","d","Symbol","iterator","o","e","TypeError","n","enumerable","configurable","writable","Object","defineProperty","r","Array","isArray","s","toString","call","slice","name","test","window","navigator","userAgent","match","m","p","D","concat","split","g","w","addEventListener","a","c","attachEvent","y","removeEventListener","detachEvent","b","top","left","height","width","offsetHeight","offsetWidth","offsetTop","offsetLeft","offsetParent","E","getBoundingClientRect","bottom","right","parentNode","document","scrollingElement","contains","body","innerHeight","innerWidth","S","indexOf","el","rect","_","classList","replace","u","defaultView","getComputedStyle","currentStyle","O","nodeType","$el","assign","dragEl","dropEl","differ","ghost","delayOnTouchOnly","disabled","animation","ghostAnimation","ghostClass","ghostStyle","chosenClass","draggable","dragging","onDrag","onMove","onDrop","onChange","forceFallback","stopPropagation","supportPassive","supportPointer","f","supportTouch","ownerDocument","nativeDraggable","M","x","$","captureAnimationState","push","target","animateRange","animate","arguments","animated","_bindEventListener","_onStart","bind","_onMove","_onDrop","_unbindEventListener","_bindMoveEvents","_bindUpEvents","_unbindMoveEvents","_unbindUpEvents","_handleDestroy","l","h","module","capture","passive","node","diff","position","exist","remove","class","zIndex","opacity","pointerEvents","cursor","setStyle","appendChild","move","clear","createElement","destroy","_resetState","type","button","touches","pointerType","tagName","toUpperCase","_onDrag","dragStartTimer","substring","matches","msMatchesSelector","webkitMatchesSelector","Error","selection","empty","getSelection","removeAllRanges","sortableDndOnDownState","setPosition","clientX","clientY","preventDefault","elementFromPoint","init","cloneNode","sortableDndOnMoveState","insertBefore","nextElementSibling","_removeWindowState","sortableDndAnimationEnd","MutationObserver","WebKitMutationObserver","MozMutationObserver","childList","attributes","subtree","onbeforeunload","Sortable","getKey","dragState","dragElement","drag","dataSource","rangeIsChanged","cloneList","SortableDnd","scrollEl","getAttribute","findIndex","_old_","_new_","oldKey","newKey","splice","changed","CALLBACKS","dragend","VirtualDragList","wrapTag","rootTag","itemTag","headerTag","footerTag","itemStyle","itemClass","rootStyle","rootClass","wrapStyle","wrapClass","list","setList","useState","setRange","root_ref","wrap_ref","last_ref","sortable","virtual","getOffset","root","ceil","scrollDirectionKey","scrollToOffset","scrollToIndex","indexOffset","scrollToBottom","scrollToTop","offsetSizeKey","clientSizeKey","scrollSizeKey","initDraggable","useImperativeHandle","reset","getSize","useEffect","setUniqueKeys","destroyDraggable","state","map","useCallback","useMemo","handleToTop","handleToBottom","onItemSizeChange","onSlotSizeChange","getItemStyle","change","itemKey","display","RootStyle","overflow","WrapStyle","padding","WrapTag","onScroll","clientSize","scrollSize","forwardRef"],"mappings":"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"}